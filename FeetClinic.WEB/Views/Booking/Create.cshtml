@using BE.BE.Treatments
@using BE.Interfaces
@using FeetClinic.WEB.Models
@model FeetClinic.WEB.Models.CreateBookingViewModel
@{
    ViewBag.Title = "Create";
}

<h2>Book time</h2>

@using (Html.BeginForm("Create","Booking"))
{
    <div class="row panel">

        <div class="col col-xs-3 form-group span3">
            <div class="form-group">
                @Html.LabelFor(model => model.TherapistsSelectListItems, new {@class = "control-label"})
                <div>
                    @Html.DropDownList("therapistId", Model.TherapistsSelectListItems,
                        new {@class = "form-control , btn btn-primary dropdown-toggle", type = "button", onchange = "CallChangefunc(this.value)"})
                </div>
            </div>
            <br/>

            <div class="form-group">
                @Html.LabelFor(model => model.TreatmentsSelectListItems, new {@class = "control-label"})
                <div>
                    @Html.ListBoxFor(m => m.SelectedTreatmentsId, Model.TreatmentsSelectListItems, new {@class = "form-control", size = 8})
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.DateTime, new {@class = "control-label"})
                <div>
                    @*<input type="date" name="date" id="date" value="@String.Format("{0:MM/dd/yyyy}", Model.DateTime)" class="form-control">*@
                    @Html.TextBox("date", Model.DateTime, "{0:yyyy-MM-dd}", new {@style = "width:100%", type = "date", @class = "form-control"})
                </div>
            </div>
        </div>

        <div class="col-xs-1 col-lg-offset-1" style="background-color: lavender;">Monday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[0])</div>
        <div class="col-xs-1" style="background-color: lavenderblush;">Tuesday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[1])</div>
        <div class="col-xs-1" style="background-color: lavender;">Wednesday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[2])</div>
        <div class="col-xs-1" style="background-color: lavenderblush;">Thursday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[3])</div>
        <div class="col-xs-1" style="background-color: lavender;">Friday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[4])</div>
        <div class="col-xs-1" style="background-color: lavenderblush;">Saturday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[5])</div>
        <div class="col-xs-1" style="background-color: lavender;">Sanday @Html.Partial("_PartialDayTimeSlot", Model.WeekFreeTimes[6])</div>
    </div>
}

<script>
    function CallChangefunc(val) {
        var dateForBooking = document.getElementById('date').value;
        window.location.href = "/Booking/Create?therapistId=" + val + "&date="+dateForBooking;
    }
</script>

@*@using (Html.BeginForm("Create", "Booking", FormMethod.Get))
    {
        <input type="date" name="date">
        @Html.DropDownList("therapistId", Model.Therapists, new {onchange = "javascript:this.form.submit()"})

        @Html.ListBoxFor(m => m.Treatments, Model.Treatments)
        ;
        <br/>
        if (Model.WeekFreeTimes != null)
        {
            <table>
                <tr>
                    @foreach (DayTimeSlotViewModel dayTimeSlotViewModel in Model.WeekFreeTimes)
                    {
                        <th>
                            @dayTimeSlotViewModel.Date.DayOfWeek.ToString()
                        </th>
                    }
                </tr>
                <tr>
                    @foreach (DayTimeSlotViewModel dayTimeSlotViewModel in Model.WeekFreeTimes)
                    {
                        <td>
                            @foreach (ITimeSlot timeSlot in dayTimeSlotViewModel.TimeSlots)
                            {
                                @timeSlot.StartTime.ToString()
                                <br/>
                            }
                        </td>
                    }
                </tr>

            </table>

        }

    }*@